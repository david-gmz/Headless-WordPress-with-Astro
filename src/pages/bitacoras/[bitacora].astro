---
import { Image } from "astro:assets";
import Layout from "@layouts/Layout.astro";
import { getAllItemSlugs } from "@lib/getAllItemSlugs";
import { getSingleItemBySlug } from "@lib/getSingleItemBySlug";
import type { WpCPTBitacoras, ItemSlugNodes } from "@lib/types";
import Map from "@components/Map.astro";

export async function getStaticPaths() {
    const bitacoras: ItemSlugNodes[] = await getAllItemSlugs("bitacorasDeViaje");
    const paths = bitacoras.map((bitacora: ItemSlugNodes) => {
        return {
            params: { bitacora: bitacora.slug },
            props: {
                bitacoraName: bitacora.name,
                bitacoraDescription: bitacora.description
            }
        };
    });

    return paths;
}

const { bitacora } = Astro.params;
const { bitacoraName, bitacoraDescription } = Astro.props;

const singleBitacora: WpCPTBitacoras = await getSingleItemBySlug(
    bitacora,
    "bitacora"
);
---

<Layout title={bitacoraName} description={bitacoraDescription}>
    <article class="max-w-screen-md mx-auto">
        <div class="grid grid-cols-2 gap-8">
            <div>
                {
                    singleBitacora.featuredImage && (
                        <Image
                            class="w-full object-cover mb-5"
                            alt={
                                singleBitacora.featuredImage.node.altText ??
                                singleBitacora.title
                            }
                            src={singleBitacora.featuredImage.node.sourceUrl}
                            width={1500}
                            height={1000}
                        />
                    )
                }
            </div>
            <div>
                <h1 class="text-2xl py-8 font-bold">{singleBitacora.title}</h1>
                <table
                    class="w-full table-auto border-collapse border-t border-slate-600">
                    <tbody>
                        <tr>
                            <td class="border-b border-slate-600 py-4 font-bold"
                                >Price:</td
                            >
                            <td class="border-b border-slate-600 text-right"
                                >{singleBitacora.lugar.nombreDelPais}</td
                            >
                        </tr>
                        <tr>
                            <td class="border-b border-slate-600 py-4 font-bold"
                                >Square Footage:</td
                            >
                            <td class="border-b border-slate-600 text-right"
                                >{singleBitacora.lugar.fecha}<sup
                                    >2</sup
                                ></td
                            >
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- <div
            class="w-full h-[400px] bg-slate-300 flex justify-center items-center">
            <Map
                lat={singleBitacora.coordenadas.latitud}
                lng={singleBitacora.coordenadas.longitud}
            />
        </div> -->
    </article>
</Layout>
